diff -r hadoop-2.4.0-src/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/task/reduce/MergeManagerImpl.java hadoop-2.4.0-src-modified-florin/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/src/main/java/org/apache/hadoop/mapreduce/task/reduce/MergeManagerImpl.java
169,170c169,170
<           Math.min(Runtime.getRuntime().maxMemory(), Integer.MAX_VALUE))
<         * maxInMemCopyUse);
---
>           Math.min(Runtime.getRuntime().maxMemory(), Long.MAX_VALUE))
>         * maxInMemCopyUse); //FLORIN
193c193
<     LOG.info("MergerManager: memoryLimit=" + memoryLimit + ", " +
---
>     LOG.info("MergerManagerXXX: memoryLimit=" + memoryLimit + ", " +
667c667
<     LOG.info("finalMerge called with " + 
---
>     LOG.info("finalMergeXXX called with " + 
677,678c677,678
<     int maxInMemReduce = (int)Math.min(
<         Runtime.getRuntime().maxMemory() * maxRedPer, Integer.MAX_VALUE);
---
>     long maxInMemReduce = (long)Math.min(
>         Runtime.getRuntime().maxMemory() * maxRedPer, Long.MAX_VALUE); //FLORIN
Only in hadoop-2.4.0-src-modified-florin/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core: target

